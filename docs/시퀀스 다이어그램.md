## 전체 구조

![Image](https://github.com/user-attachments/assets/e9596820-3816-4ad6-8527-f79e0b98a176)


## 각 기능 별 흐름 설계

![Image](https://github.com/user-attachments/assets/fac48ec2-84a3-41d4-bf4d-ffdf14e8acf4)
##### - 사용자가 토큰 생성 요청 시 시스템이 DB에서 기존 토큰 확인 후 있으면 반환, 없으면 새 토큰 생성하여 반환하는 흐름
##### - QUEUE (stand_by)
<br>

![Image](https://github.com/user-attachments/assets/88bce3e8-75ad-4300-9223-804c795e7a74)
##### - 사용자가 예약 가능 날짜 조회 시 시스템이 DB에서 날짜 목록 확인 후 예약 가능 목록 반환하는 흐름
<br>

![Image](https://github.com/user-attachments/assets/8ab40bb4-f861-4985-9e8a-9e88583073c2)
##### - 사용자가 예약 가능 좌석 조회 시 시스템이 DB에서 토큰 확인 후 있으면 대기열 상태 확인. 이후 폴링을 통해 대기 순번 확인
##### - 이 후 예약 가능 좌석 목록 반환, 토큰이 없으면 에러 메세지를 반환하는 흐름
##### - 내 차례 시 > QUEUE (active)
##### - 스케쥴러를 통한 대기열 만료 확인
<br>

![Image](https://github.com/user-attachments/assets/c8f7e492-1c33-451a-8476-b0434e15af45)
##### - 사용자가 좌석 예약 생성 시 시스템이 DB에서 좌석 상태 확인 후 '선택 가능한 좌석' 이라면 임시 배정 성공 반환, 아니라면 에러 메세지를 반환하는 흐름
##### - 스케쥴러를 통한 좌석 임시배정 상태 확인
<br>

![Image](https://github.com/user-attachments/assets/0334516c-0b6c-45fe-be70-7313bd471864)
##### - 사용자가 잔액 충전 시 시스템이 DB에서 충전 금액 확인 후 충전 성공 반환, 충전 금액이 정책과 맞지 않다면 에러 메시지를 반환하는 흐름
<br>

![Image](https://github.com/user-attachments/assets/14ba0220-b452-4644-9073-6feed4c0e25d)
##### - 사용자가 잔액 조회 시 시스템이 DB에서 잔액 조회 후 반환하는 흐름
<br>

![Image](https://github.com/user-attachments/assets/3969dd8b-64be-4c26-b0e6-22452767bb3b)
##### - 사용자가 결제 요청 시 시스템이 DB에서 좌석 상태 확인 후 '임시배정 좌석' 이고, '결제 대기' 상태라면 결제 성공 반환, 아니라면 에러 메세지를 반환하는 흐름
##### - 완료 시 > QUEUE (expired)
